<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='utf-8' />
        <meta http-equiv='X-UA-Compatible' content='IE=edge' />
        <title>–ë–∞–ª–ª–±–µ—Å</title>
        <meta name='viewport' content='width=device-width, initial-scale=1' />
        <link rel='stylesheet' href='../resources/VitalStyle.css' />

        <style>
            #studDiv,
            #parDiv {
                display: flex;
                margin: 0;
            }

            #prevStud,
            #nextStud,
            #prevPar,
            #nextPar {
                border-radius: 0;
                font-weight: 700;
            }

            #student,
            #paragraph {
                width: 100%;
            }

            #paragraph {
                border: 2px outset var(--secondary-colour);
                padding-inline: 2px;
            }

            #work {
                resize: vertical;
                min-height: 50vh;
                margin-top: 0;
            }
        </style>
    </head>
    <body>
        <h1 id='page-title'>–ë–∞–ª–ª–±–µ—Å</h1>

        <!-- Settings -->
        <details id='settings'>
            <summary id='settings-summary'>Settings</summary>
        </details>

        <!-- Page main body -->
        <div id='studDiv'>
            <button id='prevStud'>&lt;</button>
            <input type='text' id='student' placeholder='Student'>
            <button id='nextStud'>&gt;</button>
        </div>

        <div id='parDiv'>
            <button id='prevPar'>&lt;</button>
            <span id='paragraph'>Paragraph: </span>
            <button id='nextPar'>&gt;</button>
        </div>

        <textarea id='work' placeholder="Student's work"></textarea>

        <p id='author' class='box' style='font-style: italic'>
            Made by Vitaly Pavlovich Ulyanov.
        </p>
        <!-- –ê–≤—Ç–æ—Ä ‚Äî –í–∏—Ç–∞–ª–∏–π –ü–∞–≤–ª–æ–≤–∏—á –£–ª—å—è–Ω–æ–≤. -->

        <script src='../resources/VitalLogic.js'></script>
        <script>
            // Elements
            /** @type {HTMLButtonElement} */
            let prevStud = document.getElementById('prevStud');
            /** @type {HTMLButtonElement} */
            let nextStud = document.getElementById('nextStud');
            /** @type {HTMLButtonElement} */
            let prevPar = document.getElementById('prevPar');
            /** @type {HTMLButtonElement} */
            let nextPar = document.getElementById('nextPar');
            /** @type {HTMLInputElement} */
            let student = document.getElementById('student');
            /** @type {HTMLSpanElement} */
            let paragraph = document.getElementById('paragraph');
            /** @type {HTMLTextAreaElement} */
            let work = document.getElementById('work');

            // Types
            /** @typedef Mistake
             * @property paragraph {number}
             * @property start {number}
             * @property end {number}
             * @property type {string}
             * @property subtype {string}
             * @property meaning {string}
            */
            /** @typedef Work
             * @property student {string}
             * @property paragraph {number}
             * @property text {string[]}
             * @property mistakes {Mistake[]}
             */

            // Variables
            /** @type {number} */
            let studentIndex = 0;
            /** @type {number} */
            let paragraphIndex = 0;
            /** @type {Work[]} */
            let works = [
                {
                    student: '–í–∞—Å—è –ü—É–ø–∫–∏–Ω',
                    paragraph: 0,
                    text: [
                        'Today I go to shop.',
                        'I buy some apples and carots.'
                    ]
                },
                {
                    student: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
                    paragraph: 1,
                    text: [
                        '–°–µ–≥–æ–¥–Ω—è, —è —Ä–∞–Ω–æ –≤—Å—Ç–∞–ª.',
                        '–£ –º–µ–Ω—è –º–∞–ª–æ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã.',
                        '–ï—â—ë –∫–∞–∫–∞—è-—Ç–æ –æ—à–∏–±–∫–∞.'
                    ]
                }
            ];

            prevStud.addEventListener('click', function (event) {
                studentIndex = clamp(0, studentIndex - 1, works.length - 1);
                updateStudent();
            });

            nextStud.addEventListener('click', function (event) {
                studentIndex = clamp(0, studentIndex + 1, works.length - 1);
                updateStudent();
            });

            prevPar.addEventListener('click', function (event) {
                works[studentIndex].paragraph = clamp(
                    0,
                    works[studentIndex].paragraph - 1,
                    works[studentIndex].text.length - 1
                );
                updateStudent();
            });

            nextPar.addEventListener('click', function (event) {
                works[studentIndex].paragraph = clamp(
                    0,
                    works[studentIndex].paragraph + 1,
                    works[studentIndex].text.length - 1
                );
                updateStudent();
            });

            function updateStudent() {
                let w = works[studentIndex];

                student.value = w.student;
                work.value = w.text[w.paragraph];
                paragraph.textContent = `${w.paragraph + 1}/${w.text.length}`;
            }

            updateStudent();

            /**
             * @param {number} min
             * @param {number} value
             * @param {number} max
            */
            function clamp(min, value, max) {
                return value < min
                    ? min
                    : value > max
                        ? max
                        : value;
            }

            generateLanguagesList([
                {
                    name: 'English [Vitaly Ulyanov]',
                    langTags: ['en', 'en-AU', 'en-BZ', 'en-CA', 'en-CB', 'en-GB', 'en-IE', 'en-JM', 'en-NZ', 'en-PH', 'en-TT', 'en-US', 'en-ZA', 'en-ZW'],
                    elements: [
                        {
                            "id": "page-title",
                            "childNodesTexts": [
                                "–ë–∞–ª–ª–±–µ—Å"
                            ]
                        },
                        {
                            "id": "settings-summary",
                            "childNodesTexts": [
                                "Settings"
                            ]
                        },
                        {
                            "id": "fontLabel",
                            "childNodesTexts": [
                                "Font"
                            ]
                        },
                        {
                            "id": "fontInput",
                            "childNodesTexts": [],
                            "placeholder": "Type a font's name and press Enter"
                        },
                        {
                            "id": "primLabel",
                            "childNodesTexts": [
                                "Background colour"
                            ]
                        },
                        {
                            "id": "secLabel",
                            "childNodesTexts": [
                                "Text colour"
                            ]
                        },
                        {
                            "id": "acc1Label",
                            "childNodesTexts": [
                                "Accent colour 1"
                            ]
                        },
                        {
                            "id": "acc2Label",
                            "childNodesTexts": [
                                "Accent colour 2"
                            ]
                        },
                        {
                            "id": "loadLabel",
                            "childNodesTexts": [
                                "üìÅ Load colours"
                            ]
                        },
                        {
                            "id": "saveColoursButton",
                            "childNodesTexts": [
                                "üíæ Save colours"
                            ]
                        },
                        {
                            "id": "exportLang",
                            "childNodesTexts": [
                                "üåê Export texts for translation"
                            ]
                        },
                        {
                            "id": "author",
                            "childNodesTexts": [
                                "Made by Vitaly Pavlovich Ulyanov."
                            ]
                        },
                        {
                            "id": "fullscreenButton",
                            "childNodesTexts": [
                                "‚ñ≤",
                                "Fullscreen"
                            ]
                        }
                    ]
                },
                {
                    name: '–†—É—Å—Å–∫–∏–π [–í–∏—Ç–∞–ª–∏–π –£–ª—å—è–Ω–æ–≤]',
                    langTags: ['ru', 'ru-RU'],
                    elements: [
                        {
                            "id": "page-title",
                            "childNodesTexts": [
                                "–ë–∞–ª–ª–±–µ—Å"
                            ]
                        },
                        {
                            "id": "settings-summary",
                            "childNodesTexts": [
                                "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                            ]
                        },
                        {
                            "id": "fontLabel",
                            "childNodesTexts": [
                                "–®—Ä–∏—Ñ—Ç"
                            ]
                        },
                        {
                            "id": "fontInput",
                            "childNodesTexts": [],
                            "placeholder": "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ Enter"
                        },
                        {
                            "id": "primLabel",
                            "childNodesTexts": [
                                "–¶–≤–µ—Ç —Ñ–æ–Ω–∞"
                            ]
                        },
                        {
                            "id": "secLabel",
                            "childNodesTexts": [
                                "–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞"
                            ]
                        },
                        {
                            "id": "acc1Label",
                            "childNodesTexts": [
                                "–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç 1"
                            ]
                        },
                        {
                            "id": "acc2Label",
                            "childNodesTexts": [
                                "–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç 2"
                            ]
                        },
                        {
                            "id": "loadLabel",
                            "childNodesTexts": [
                                "üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ü–≤–µ—Ç–∞"
                            ]
                        },
                        {
                            "id": "saveColoursButton",
                            "childNodesTexts": [
                                "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–≤–µ—Ç–∞"
                            ]
                        },
                        {
                            "id": "exportLang",
                            "childNodesTexts": [
                                "üåê –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞"
                            ]
                        },
                        {
                            "id": "author",
                            "childNodesTexts": [
                                "–ê–≤—Ç–æ—Ä ‚Äî –í–∏—Ç–∞–ª–∏–π –ü–∞–≤–ª–æ–≤–∏—á –£–ª—å—è–Ω–æ–≤."
                            ]
                        },
                        {
                            "id": "fullscreenButton",
                            "childNodesTexts": [
                                "‚ñ≤",
                                "–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω"
                            ]
                        }
                    ]
                }
            ]);
        </script>
    </body>
</html>
